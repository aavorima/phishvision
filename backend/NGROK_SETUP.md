# Setting Up ngrok for QR Code Testing

QR codes generated by PhishVision need to be accessible from mobile devices. Since `localhost` URLs don't work on phones, we use ngrok to create a public tunnel.

## Quick Start

### Option 1: Using the Helper Script (Recommended)

1. **Install ngrok** (if not already installed):
   ```bash
   # Download from https://ngrok.com/download
   # Or on macOS:
   brew install ngrok
   
   # Or on Windows, download the executable
   ```

2. **Start the app with ngrok**:
   ```bash
   cd backend
   python start_with_ngrok.py
   ```

   This will:
   - Start ngrok tunnel
   - Get the public URL
   - Update your `.env` file with `BASE_URL`
   - Start the Flask app

3. **Create new QR campaigns** - they will automatically use the ngrok URL!

### Option 2: Manual Setup

1. **Start ngrok in a separate terminal**:
   ```bash
   ngrok http 5000
   ```

2. **Copy the HTTPS URL** (e.g., `https://abc123.ngrok.io`)

3. **Set the BASE_URL environment variable**:
   ```bash
   # Linux/Mac
   export BASE_URL=https://abc123.ngrok.io
   
   # Windows PowerShell
   $env:BASE_URL="https://abc123.ngrok.io"
   
   # Or add to .env file:
   BASE_URL=https://abc123.ngrok.io
   ```

4. **Start your Flask app**:
   ```bash
   cd backend
   python app.py
   ```

5. **Create new QR campaigns** - they will use the ngrok URL!

## Important Notes

- **ngrok URLs change each time** you restart ngrok (unless you have a paid plan with a static domain)
- **Update BASE_URL** whenever you restart ngrok
- **Existing QR codes** won't update automatically - you need to create new ones
- The **ngrok dashboard** is available at `http://localhost:4040` to see requests

## Testing QR Codes

1. Start ngrok and note the public URL
2. Create a new QR campaign in PhishVision
3. Download or display the QR code
4. Scan with your phone
5. The phone will open the ngrok URL, which redirects to your landing page or training page

## Troubleshooting

### QR code doesn't open anything
- Check that ngrok is running: `curl http://localhost:4040/api/tunnels`
- Verify BASE_URL is set correctly: `echo $BASE_URL`
- Make sure you created the QR campaign AFTER setting BASE_URL

### CORS errors
- The app is configured to allow ngrok URLs automatically
- If you see CORS errors, check that your ngrok URL matches the pattern

### ngrok not found
- Install ngrok from https://ngrok.com/download
- Or use `pip install pyngrok` for Python integration

## Using a Static ngrok Domain (Paid)

If you have a paid ngrok account with a static domain:

1. Start ngrok with your domain:
   ```bash
   ngrok http 5000 --domain=your-static-domain.ngrok.io
   ```

2. Set BASE_URL to your static domain in `.env`:
   ```
   BASE_URL=https://your-static-domain.ngrok.io
   ```

This way, your QR codes will always work without updating!

