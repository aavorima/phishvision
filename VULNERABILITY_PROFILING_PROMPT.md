# PhishVision - Employee Vulnerability Profiling & Targeted Campaign System

## Implementation Prompt for Claude CLI

---

## üéØ PROJECT OBJECTIVE

Implement an **Employee Vulnerability Profiling System** for PhishVision that:

1. **Collects behavioral data** from phishing campaigns (clicks, credential submissions, response times, device info)
2. **Analyzes vulnerabilities by demographics** (age groups, departments, job roles, tenure)
3. **Identifies security gaps** at individual, department, and organization levels
4. **Enables targeted campaigns** based on vulnerability profiles
5. **Generates actionable reports** for security teams

---

## üìÅ PROJECT CONTEXT

**Working Directory:** `/home/morpho/Desktop/Hackathon/phishvision/`

**Existing Structure:**
- `backend/` - Flask API with SQLAlchemy (SQLite)
- `frontend/` - React 18 with Tailwind CSS
- `backend/models.py` - Contains existing models (Employee, Campaign, CampaignTarget, UserRiskScore, etc.)
- `backend/routes/` - API route modules

**Existing Relevant Models:**
- `Employee` - Has: name, email, department, job_title
- `Campaign` - Phishing campaigns
- `CampaignTarget` - Individual targets with: sent_at, opened_at, clicked_at, submitted_credentials
- `UserRiskScore` - Risk levels per user
- `CredentialCapture` - Captured credentials with device/browser info

---

## üóÑÔ∏è DATABASE SCHEMA ADDITIONS

### 1. Extend Employee Model

Add these fields to the existing `Employee` model in `backend/models.py`:

```python
# Add to Employee model
age_group = db.Column(db.String(20))  # '18-25', '26-35', '36-45', '46-55', '56+'
hire_date = db.Column(db.DateTime)
tenure_months = db.Column(db.Integer)  # Auto-calculated
job_level = db.Column(db.String(20))  # 'entry', 'mid', 'senior', 'manager', 'executive'
previous_training = db.Column(db.Boolean, default=False)
last_training_date = db.Column(db.DateTime)
```

### 2. New Model: VulnerabilityProfile

```python
class VulnerabilityProfile(db.Model):
    """Individual employee vulnerability assessment"""
    id = db.Column(db.Integer, primary_key=True)
    employee_id = db.Column(db.Integer, db.ForeignKey('employee.id'), nullable=False)
    
    # Overall scores (0-100)
    overall_vulnerability_score = db.Column(db.Float, default=50.0)
    
    # Attack vector vulnerabilities (0-100 each)
    email_phishing_score = db.Column(db.Float, default=50.0)
    spear_phishing_score = db.Column(db.Float, default=50.0)
    qr_phishing_score = db.Column(db.Float, default=50.0)
    sms_phishing_score = db.Column(db.Float, default=50.0)
    
    # Technique vulnerabilities (0-100 each)
    urgency_susceptibility = db.Column(db.Float, default=50.0)      # "Act now!" tactics
    authority_susceptibility = db.Column(db.Float, default=50.0)    # "CEO needs this"
    curiosity_susceptibility = db.Column(db.Float, default=50.0)    # "You won't believe..."
    fear_susceptibility = db.Column(db.Float, default=50.0)         # "Account suspended"
    reward_susceptibility = db.Column(db.Float, default=50.0)       # "You've won!"
    social_proof_susceptibility = db.Column(db.Float, default=50.0) # "Everyone is doing..."
    
    # Behavioral metrics
    avg_click_time_seconds = db.Column(db.Float)  # How fast they click (faster = more vulnerable)
    total_campaigns_received = db.Column(db.Integer, default=0)
    total_emails_opened = db.Column(db.Integer, default=0)
    total_links_clicked = db.Column(db.Integer, default=0)
    total_credentials_submitted = db.Column(db.Integer, default=0)
    
    # Improvement tracking
    improvement_trend = db.Column(db.String(20))  # 'improving', 'stable', 'declining'
    last_incident_date = db.Column(db.DateTime)
    consecutive_passes = db.Column(db.Integer, default=0)  # Campaigns passed without clicking
    
    # Timestamps
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    updated_at = db.Column(db.DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    
    # Relationships
    employee = db.relationship('Employee', backref='vulnerability_profile')
```

### 3. New Model: DepartmentVulnerability

```python
class DepartmentVulnerability(db.Model):
    """Aggregated department-level vulnerability metrics"""
    id = db.Column(db.Integer, primary_key=True)
    department = db.Column(db.String(100), nullable=False, unique=True)
    
    # Aggregate scores
    avg_vulnerability_score = db.Column(db.Float, default=50.0)
    employee_count = db.Column(db.Integer, default=0)
    high_risk_count = db.Column(db.Integer, default=0)  # Employees with score > 70
    
    # Attack vector breakdown
    email_phishing_avg = db.Column(db.Float, default=50.0)
    spear_phishing_avg = db.Column(db.Float, default=50.0)
    qr_phishing_avg = db.Column(db.Float, default=50.0)
    sms_phishing_avg = db.Column(db.Float, default=50.0)
    
    # Weakest technique for department
    weakest_technique = db.Column(db.String(50))
    weakest_technique_score = db.Column(db.Float)
    
    # Campaign metrics
    total_campaigns = db.Column(db.Integer, default=0)
    overall_click_rate = db.Column(db.Float, default=0.0)
    overall_submission_rate = db.Column(db.Float, default=0.0)
    
    # Timestamps
    last_calculated = db.Column(db.DateTime, default=datetime.utcnow)
```

### 4. New Model: AgeGroupVulnerability

```python
class AgeGroupVulnerability(db.Model):
    """Age-based vulnerability analysis"""
    id = db.Column(db.Integer, primary_key=True)
    age_group = db.Column(db.String(20), nullable=False, unique=True)  # '18-25', '26-35', etc.
    
    # Aggregate metrics
    employee_count = db.Column(db.Integer, default=0)
    avg_vulnerability_score = db.Column(db.Float, default=50.0)
    
    # Attack vector effectiveness for this age group
    email_susceptibility = db.Column(db.Float, default=50.0)
    qr_susceptibility = db.Column(db.Float, default=50.0)
    sms_susceptibility = db.Column(db.Float, default=50.0)
    
    # Most effective techniques for this age group
    most_effective_technique = db.Column(db.String(50))
    technique_effectiveness_score = db.Column(db.Float)
    
    # Behavioral patterns
    avg_response_time_seconds = db.Column(db.Float)
    click_rate = db.Column(db.Float, default=0.0)
    credential_submission_rate = db.Column(db.Float, default=0.0)
    
    last_calculated = db.Column(db.DateTime, default=datetime.utcnow)
```

### 5. New Model: CampaignAnalytics (Enhanced)

```python
class CampaignAnalytics(db.Model):
    """Detailed campaign results for vulnerability analysis"""
    id = db.Column(db.Integer, primary_key=True)
    campaign_id = db.Column(db.Integer, db.ForeignKey('campaign.id'), nullable=False)
    target_id = db.Column(db.Integer, db.ForeignKey('campaign_target.id'), nullable=False)
    employee_id = db.Column(db.Integer, db.ForeignKey('employee.id'))
    
    # Campaign metadata (for analysis)
    attack_vector = db.Column(db.String(20))  # 'email', 'qr', 'sms'
    technique_used = db.Column(db.String(50))  # 'urgency', 'authority', 'curiosity', etc.
    template_category = db.Column(db.String(50))  # 'credential_harvest', 'malware', 'data_theft'
    difficulty_level = db.Column(db.String(20))  # 'easy', 'medium', 'hard'
    
    # Interaction data
    email_opened = db.Column(db.Boolean, default=False)
    link_clicked = db.Column(db.Boolean, default=False)
    credentials_submitted = db.Column(db.Boolean, default=False)
    
    # Timing analysis
    time_to_open_seconds = db.Column(db.Integer)
    time_to_click_seconds = db.Column(db.Integer)
    time_to_submit_seconds = db.Column(db.Integer)
    
    # Context
    device_type = db.Column(db.String(20))  # 'desktop', 'mobile', 'tablet'
    time_of_day = db.Column(db.String(20))  # 'morning', 'afternoon', 'evening', 'night'
    day_of_week = db.Column(db.String(10))
    
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
```

### 6. Extend CustomTemplate Model

Add technique tagging to templates:

```python
# Add to CustomTemplate model
technique_type = db.Column(db.String(50))  # 'urgency', 'authority', 'curiosity', 'fear', 'reward', 'social_proof'
difficulty_level = db.Column(db.String(20), default='medium')  # 'easy', 'medium', 'hard'
target_demographic = db.Column(db.String(100))  # Optional: 'executives', 'new_hires', 'IT', etc.
```

---

## üîß NEW BACKEND SERVICES

### 1. Create: `backend/services/vulnerability_analyzer.py`

```python
"""
Vulnerability Analysis Service

Responsibilities:
1. Calculate individual vulnerability scores after each campaign
2. Aggregate department-level vulnerabilities  
3. Analyze age group patterns
4. Identify technique susceptibilities
5. Track improvement/decline trends
"""

class VulnerabilityAnalyzer:
    
    def calculate_employee_vulnerability(self, employee_id: int) -> dict:
        """
        Calculate comprehensive vulnerability profile for an employee.
        
        Algorithm:
        - Base score: 50 (neutral)
        - Each click: +10 to relevant scores
        - Each credential submission: +20 to relevant scores
        - Each pass (no click): -5 to relevant scores
        - Factor in response time (faster click = higher vulnerability)
        - Cap scores at 0-100
        
        Returns: Updated VulnerabilityProfile data
        """
        pass
    
    def analyze_technique_susceptibility(self, employee_id: int) -> dict:
        """
        Analyze which psychological techniques the employee falls for.
        
        Based on:
        - template.technique_type of failed campaigns
        - Weight by severity (click vs credential submission)
        
        Returns: {technique: susceptibility_score}
        """
        pass
    
    def calculate_department_vulnerability(self, department: str) -> dict:
        """
        Aggregate vulnerability metrics for a department.
        
        Calculates:
        - Average scores across all employees
        - Identifies weakest areas
        - Counts high-risk employees
        - Calculates click/submission rates
        """
        pass
    
    def calculate_age_group_vulnerability(self, age_group: str) -> dict:
        """
        Analyze vulnerability patterns for an age group.
        
        Identifies:
        - Most effective attack vectors
        - Most effective techniques
        - Behavioral patterns (response time, etc.)
        """
        pass
    
    def get_improvement_trend(self, employee_id: int, lookback_days: int = 90) -> str:
        """
        Analyze if employee security awareness is improving.
        
        Returns: 'improving', 'stable', or 'declining'
        """
        pass
    
    def recalculate_all_profiles(self) -> dict:
        """
        Batch recalculation of all vulnerability profiles.
        Run after campaign completion or on schedule.
        """
        pass
```

### 2. Create: `backend/services/targeted_campaign_service.py`

```python
"""
Targeted Campaign Service

Responsibilities:
1. Recommend targets based on vulnerability profiles
2. Select appropriate templates based on identified weaknesses
3. Generate targeted campaign configurations
4. Optimize campaign timing based on behavioral data
"""

class TargetedCampaignService:
    
    def get_recommended_targets(self, criteria: dict) -> list:
        """
        Get employees matching vulnerability criteria.
        
        Criteria options:
        - min_vulnerability_score: float
        - department: str
        - age_group: str
        - technique_weakness: str (e.g., 'urgency', 'authority')
        - attack_vector: str (e.g., 'email', 'qr', 'sms')
        - exclude_recent_days: int (don't re-target recently tested)
        
        Returns: List of Employee objects with vulnerability data
        """
        pass
    
    def recommend_template_for_employee(self, employee_id: int) -> dict:
        """
        Recommend the most effective template for testing an employee.
        
        Based on:
        - Employee's weakest technique susceptibility
        - Attack vectors they haven't been tested on
        - Templates they haven't seen before
        
        Returns: {template_id, technique, reasoning}
        """
        pass
    
    def generate_targeted_campaign(self, config: dict) -> dict:
        """
        Generate a full campaign configuration targeting specific vulnerabilities.
        
        Config options:
        - target_type: 'department' | 'age_group' | 'high_risk' | 'specific_weakness'
        - target_value: str (e.g., 'Finance', '46-55', 'authority')
        - difficulty: 'easy' | 'medium' | 'hard' | 'progressive'
        - attack_vector: 'email' | 'qr' | 'sms' | 'mixed'
        
        Returns: Campaign configuration with targets and template assignments
        """
        pass
    
    def get_optimal_send_time(self, employee_id: int) -> dict:
        """
        Analyze when an employee is most likely to fall for phishing.
        
        Based on historical click data timing patterns.
        
        Returns: {day_of_week, time_of_day, confidence}
        """
        pass
    
    def create_progressive_campaign(self, employee_ids: list) -> list:
        """
        Create a series of campaigns with increasing difficulty.
        
        Starts with easier phishing (obvious red flags) and progressively
        becomes more sophisticated to measure true vulnerability.
        
        Returns: List of campaign configurations
        """
        pass
```

### 3. Create: `backend/services/gap_report_service.py`

```python
"""
Security Gap Reporting Service

Responsibilities:
1. Generate executive summary reports
2. Create department comparison reports
3. Identify organization-wide gaps
4. Provide actionable recommendations
5. Export reports in various formats
"""

class GapReportService:
    
    def generate_executive_summary(self, date_range: tuple = None) -> dict:
        """
        High-level organization security posture.
        
        Includes:
        - Overall vulnerability score
        - Top 5 riskiest departments
        - Top 5 riskiest age groups
        - Most exploited techniques
        - Trend over time
        - Key recommendations
        """
        pass
    
    def generate_department_report(self, department: str) -> dict:
        """
        Detailed department vulnerability analysis.
        
        Includes:
        - Department vulnerability breakdown
        - Employee risk distribution (pie chart data)
        - Weakness areas with scores
        - Comparison to organization average
        - Individual high-risk employees (anonymized option)
        - Recommended training focus areas
        """
        pass
    
    def generate_gap_analysis(self) -> dict:
        """
        Identify security gaps across the organization.
        
        Returns:
        - gaps: List of identified gaps with severity
        - affected_count: Employees affected per gap
        - recommendations: Prioritized action items
        - estimated_risk_reduction: If gaps are addressed
        """
        pass
    
    def generate_demographic_insights(self) -> dict:
        """
        Age group and tenure-based analysis.
        
        Identifies patterns like:
        - "New hires (0-6 months) are 3x more likely to click"
        - "Employees 56+ most susceptible to authority-based attacks"
        - "QR phishing most effective on 26-35 age group"
        """
        pass
    
    def generate_trend_report(self, months: int = 6) -> dict:
        """
        Track security awareness trends over time.
        
        Shows:
        - Monthly vulnerability score changes
        - Click rate trends
        - Training effectiveness correlation
        - Improvement/decline by department
        """
        pass
    
    def export_report(self, report_type: str, format: str = 'json') -> bytes:
        """
        Export report in specified format.
        
        Formats: 'json', 'csv', 'pdf'
        """
        pass
```

---

## üõ£Ô∏è NEW API ROUTES

### Create: `backend/routes/vulnerability_routes.py`

```python
"""
Vulnerability Analysis API Routes

Endpoints:
- GET  /api/vulnerability/profile/<employee_id>     - Get employee vulnerability profile
- POST /api/vulnerability/calculate/<employee_id>   - Recalculate employee profile
- POST /api/vulnerability/calculate/all             - Batch recalculate all profiles
- GET  /api/vulnerability/department/<department>   - Get department vulnerabilities
- GET  /api/vulnerability/departments               - Get all departments summary
- GET  /api/vulnerability/age-groups                - Get age group analysis
- GET  /api/vulnerability/techniques                - Get technique effectiveness
- GET  /api/vulnerability/high-risk                 - Get high-risk employees
- GET  /api/vulnerability/trends                    - Get vulnerability trends over time
"""
```

### Create: `backend/routes/targeting_routes.py`

```python
"""
Targeted Campaign API Routes

Endpoints:
- POST /api/targeting/recommend                     - Get recommended targets based on criteria
- GET  /api/targeting/employee/<id>/weakness        - Get employee's weaknesses
- GET  /api/targeting/employee/<id>/recommend-template - Recommend template for employee
- POST /api/targeting/generate-campaign             - Generate targeted campaign config
- GET  /api/targeting/optimal-timing/<employee_id>  - Get optimal send time
- POST /api/targeting/progressive-campaign          - Create progressive difficulty campaign
"""
```

### Create: `backend/routes/report_routes.py`

```python
"""
Gap Analysis & Reporting API Routes

Endpoints:
- GET  /api/reports/executive-summary               - Executive summary report
- GET  /api/reports/department/<department>         - Department detailed report
- GET  /api/reports/gap-analysis                    - Organization gap analysis
- GET  /api/reports/demographics                    - Age/tenure insights
- GET  /api/reports/trends                          - Historical trends
- GET  /api/reports/export/<type>?format=json|csv   - Export report
- GET  /api/reports/comparison                      - Department comparison
"""
```

---

## üñ•Ô∏è NEW FRONTEND COMPONENTS

### 1. Create: `frontend/src/components/VulnerabilityDashboard.js`

**Purpose:** Main vulnerability analysis dashboard

**Sections:**
- Organization vulnerability score gauge
- Department heatmap (color-coded by risk)
- Age group vulnerability chart (bar chart)
- Technique susceptibility radar chart
- High-risk employees table
- Trend line chart (last 6 months)

### 2. Create: `frontend/src/components/DepartmentAnalysis.js`

**Purpose:** Deep-dive into department vulnerabilities

**Features:**
- Department selector dropdown
- Vulnerability breakdown cards
- Employee risk distribution pie chart
- Comparison to org average
- Individual employee scores (with privacy toggle)
- Export department report button

### 3. Create: `frontend/src/components/TargetedCampaignBuilder.js`

**Purpose:** Create campaigns targeting specific vulnerabilities

**Flow:**
1. Select targeting criteria (department, age group, technique weakness, etc.)
2. Preview matched employees with vulnerability scores
3. Get template recommendations based on weaknesses
4. Configure campaign settings
5. Review and launch

**Features:**
- Multi-filter target selection
- Smart template suggestions
- Optimal timing recommendations
- Progressive difficulty option
- Campaign preview before launch

### 4. Create: `frontend/src/components/GapReport.js`

**Purpose:** Security gap analysis and reporting

**Sections:**
- Executive summary card
- Gap identification list with severity badges
- Affected employee counts
- Prioritized recommendations
- Export options (PDF, CSV)

### 5. Create: `frontend/src/components/EmployeeVulnerabilityProfile.js`

**Purpose:** Individual employee vulnerability detail view

**Shows:**
- Overall vulnerability score with gauge
- Attack vector breakdown (email, QR, SMS)
- Technique susceptibility radar chart
- Campaign history timeline
- Improvement trend indicator
- Recommended training areas

### 6. Update: `frontend/src/components/EmployeeManager.js`

**Add:**
- Age group column
- Tenure column
- Vulnerability score column (sortable)
- Bulk import with demographics
- Link to individual vulnerability profile

### 7. Update: `frontend/src/components/TemplateManager.js`

**Add:**
- Technique type selector (urgency, authority, etc.)
- Difficulty level selector
- Target demographic field
- Filter templates by technique

---

## üìä DATA FLOW

### Campaign Completion Flow:

```
Campaign Ends
    |
    v
+---------------------------+
| Collect CampaignTarget    |
| results (opens, clicks,   |
| submissions)              |
+---------------------------+
    |
    v
+---------------------------+
| Create CampaignAnalytics  |
| records with context      |
| (technique, timing, etc.) |
+---------------------------+
    |
    v
+---------------------------+
| VulnerabilityAnalyzer     |
| .calculate_employee_      |
| vulnerability() for each  |
| target                    |
+---------------------------+
    |
    v
+---------------------------+
| Update VulnerabilityProfile|
| for each affected employee |
+---------------------------+
    |
    v
+---------------------------+
| Recalculate Department    |
| Vulnerability aggregates  |
+---------------------------+
    |
    v
+---------------------------+
| Recalculate AgeGroup      |
| Vulnerability aggregates  |
+---------------------------+
```

### Targeted Campaign Creation Flow:

```
Security Admin opens Targeted Campaign Builder
    |
    v
+---------------------------+
| Select targeting criteria |
| - Department: "Finance"   |
| - Weakness: "urgency"     |
| - Min score: 60           |
+---------------------------+
    |
    v
+---------------------------+
| TargetedCampaignService   |
| .get_recommended_targets()|
+---------------------------+
    |
    v
+---------------------------+
| Display matching employees|
| with vulnerability details|
+---------------------------+
    |
    v
+---------------------------+
| Get template recommendations|
| based on target weaknesses |
+---------------------------+
    |
    v
+---------------------------+
| Admin reviews & launches  |
| targeted campaign         |
+---------------------------+
```

---

## üéØ IMPLEMENTATION ORDER

### Phase 1: Database & Models
1. Extend Employee model with demographics
2. Create VulnerabilityProfile model
3. Create DepartmentVulnerability model
4. Create AgeGroupVulnerability model
5. Create CampaignAnalytics model
6. Extend CustomTemplate model
7. Run migrations

### Phase 2: Core Services
1. Implement VulnerabilityAnalyzer service
2. Implement TargetedCampaignService
3. Implement GapReportService
4. Add hooks to existing campaign routes to trigger analysis

### Phase 3: API Routes
1. Create vulnerability_routes.py
2. Create targeting_routes.py
3. Create report_routes.py
4. Register blueprints in app.py

### Phase 4: Frontend - Analysis
1. Create VulnerabilityDashboard component
2. Create DepartmentAnalysis component
3. Create EmployeeVulnerabilityProfile component
4. Update EmployeeManager with new fields

### Phase 5: Frontend - Targeting
1. Create TargetedCampaignBuilder component
2. Update TemplateManager with technique tagging
3. Create GapReport component

### Phase 6: Integration & Testing
1. Hook campaign completion to vulnerability recalculation
2. Test end-to-end flows
3. Seed sample demographic data for testing

---

## üìù SAMPLE API RESPONSES

### GET /api/vulnerability/profile/123

```json
{
  "employee_id": 123,
  "employee_name": "John Doe",
  "department": "Finance",
  "age_group": "36-45",
  "overall_vulnerability_score": 72.5,
  "risk_level": "high",
  "attack_vector_scores": {
    "email_phishing": 75.0,
    "spear_phishing": 80.0,
    "qr_phishing": 45.0,
    "sms_phishing": 60.0
  },
  "technique_susceptibility": {
    "urgency": 85.0,
    "authority": 70.0,
    "curiosity": 55.0,
    "fear": 65.0,
    "reward": 40.0,
    "social_proof": 50.0
  },
  "behavioral_metrics": {
    "avg_click_time_seconds": 45,
    "total_campaigns": 12,
    "total_clicked": 8,
    "total_credentials_submitted": 3,
    "click_rate": 66.7
  },
  "improvement_trend": "stable",
  "recommended_training": ["Urgency Recognition", "Authority Verification"],
  "last_incident": "2024-12-01T14:30:00Z"
}
```

### GET /api/vulnerability/departments

```json
{
  "departments": [
    {
      "name": "Finance",
      "employee_count": 25,
      "avg_vulnerability_score": 68.5,
      "high_risk_count": 8,
      "click_rate": 45.2,
      "weakest_technique": "authority",
      "risk_level": "high"
    },
    {
      "name": "Engineering",
      "employee_count": 40,
      "avg_vulnerability_score": 35.2,
      "high_risk_count": 2,
      "click_rate": 12.5,
      "weakest_technique": "curiosity",
      "risk_level": "low"
    }
  ],
  "organization_average": 52.3
}
```

### POST /api/targeting/recommend

**Request:**
```json
{
  "criteria": {
    "department": "Finance",
    "min_vulnerability_score": 60,
    "technique_weakness": "urgency",
    "exclude_recent_days": 30
  }
}
```

**Response:**
```json
{
  "matched_employees": 12,
  "targets": [
    {
      "employee_id": 123,
      "name": "John Doe",
      "email": "john@company.com",
      "vulnerability_score": 72.5,
      "urgency_susceptibility": 85.0,
      "last_campaign_days_ago": 45,
      "recommended_template": {
        "id": 15,
        "name": "Urgent: Password Expiry",
        "technique": "urgency",
        "match_reason": "High urgency susceptibility (85.0)"
      }
    }
  ],
  "optimal_send_time": {
    "day": "Tuesday",
    "time": "10:00-11:00",
    "timezone": "local"
  }
}
```

### GET /api/reports/gap-analysis

```json
{
  "organization_score": 52.3,
  "gaps": [
    {
      "id": 1,
      "type": "technique",
      "name": "Authority-Based Attack Susceptibility",
      "severity": "high",
      "affected_employees": 45,
      "affected_percentage": 36.0,
      "description": "45 employees (36%) show high susceptibility to authority-based phishing",
      "departments_affected": ["Finance", "HR", "Executive"],
      "recommendation": "Implement mandatory training on authority verification protocols"
    },
    {
      "id": 2,
      "type": "demographic",
      "name": "New Hire Vulnerability",
      "severity": "critical",
      "affected_employees": 18,
      "affected_percentage": 90.0,
      "description": "90% of employees with <6 months tenure clicked on phishing",
      "recommendation": "Add security awareness to onboarding program"
    }
  ],
  "recommendations_priority": [
    {
      "priority": 1,
      "action": "Security awareness training for Finance department",
      "impact": "Would reduce org vulnerability by ~8%",
      "effort": "medium"
    }
  ],
  "generated_at": "2024-12-10T15:30:00Z"
}
```

---

## ‚ö†Ô∏è IMPORTANT NOTES

1. **Privacy Considerations**: Include option to anonymize individual employee data in reports
2. **Score Normalization**: Ensure all scores stay within 0-100 range
3. **Recalculation Triggers**: Auto-recalculate after campaign ends, manual trigger available
4. **Default Scores**: New employees start at 50 (neutral) until they have campaign data
5. **Minimum Data**: Require at least 3 campaigns before showing vulnerability insights
6. **API Authentication**: All vulnerability/report endpoints require admin role

---

## üöÄ DELIVERABLES

After implementation, the system should support:

1. ‚úÖ View organization-wide vulnerability dashboard
2. ‚úÖ Drill down into department vulnerabilities
3. ‚úÖ Analyze age group patterns
4. ‚úÖ View individual employee vulnerability profiles
5. ‚úÖ Create targeted campaigns based on vulnerabilities
6. ‚úÖ Get smart template recommendations
7. ‚úÖ Generate gap analysis reports
8. ‚úÖ Track improvement trends over time
9. ‚úÖ Export reports for stakeholders

---

## üìö REFERENCE FILES

Before implementing, review these existing files:
- `backend/models.py` - Existing models to extend
- `backend/routes/campaign_routes.py` - Campaign flow to integrate with
- `backend/routes/employee_routes.py` - Employee management patterns
- `backend/routes/risk_routes.py` - Risk scoring patterns
- `frontend/src/components/Dashboard.js` - Dashboard patterns
- `frontend/src/components/CampaignManager.js` - Campaign UI patterns
